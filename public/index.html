<!DOCTYPE html>
<html lang="EN">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Pete Sattler">
        <meta name="description" content="NYU SPS INFO1-CE9755 Final Project">
        <meta name="email" content="peter@sattler22.net ">
        <title id="title">Pete's World Banking Empire: Home Page</title>
        <link rel="stylesheet" href="/stylesheets/header.css">
        <link rel="stylesheet" href="/stylesheets/navbar.css">
        <style>
            table, th, td {
                border: 1px solid black;
            }
            th, td {
                padding: 15px;
            }
            th {
                text-align: left;
            }
            tr:nth-child(even) {
                background-color: #f2f2f2
            }
        </style>
        <script src="/javascripts/include.js"></script>
    </head>
    <body>
        <div w3-include-html="/header.html"></div>
        <div class="navbar">
            <ul>
                <li><a href="addcust.html">Add Customer</a></li>
            </ul>
        </div>     
        <div id="customers"></div>
        <div w3-include-html="/footer.html"></div>
    </body>
    <script>
        includeHTML();
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "http://localhost:8080/api/money-transfer/customers");
        xhr.onreadystatechange = function() {
            if(xhr.readyState === 4) {
                if(xhr.status === 200) {
                    var data = JSON.parse(xhr.responseText);
                    displayCustomers(data);
                }
                else {
                    alert("No customer data found!!!");
                }
            }
        };
        xhr.send();
        
        function displayCustomers(data) {
            var content = "<table>";
            for(var row = 0; row < data.length; row++) {
                if(row == 0) {
                    content += "<tr>";
                    content += "<th>Customer ID</th>";
                    content += "<th>First Name</th>";
                    content += "<th>Last Name</th>";
                    content += "<th>Gender</th>";
                    content += "<th>Phone</th>";
                    content += '<th colspan="4">Address</th>';
                    content += "</tr>";
                }
                content += "<tr>";
                content += "<td>" + data[row].id + "</td>";
                content += "<td>" + data[row].firstName + "</td>";
                content += "<td>" + data[row].lastName + "</td>";
                content += "<td>" + data[row].gender + "</td>";
                content += "<td>" + data[row].phone + "</td>";
                content += "<td>" + data[row].address.street + "</td>";
                content += "<td>" + data[row].address.city + "</td>";
                content += "<td>" + data[row].address.state + "</td>";
                content += "<td>" + data[row].address.zip + "</td>";
                content += "</tr>";
            }
            content += "</table>";
            document.getElementById("customers").innerHTML = content;
        }
    </script>
</html>
